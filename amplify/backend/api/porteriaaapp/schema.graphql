enum Role {
  RESIDENT
  GUARD
  ADMIN
  SUPER_ADMIN
}

# Habilitamos acceso PÃšBLICO total para poder crear usuarios desde el Login
type User @model @auth(rules: [
  { allow: public }
]) {
  id: ID!
  username: String! @index(name: "byUsername", queryField: "userByUsername")
  password: String!
  isFirstLogin: Boolean!
  role: Role!
  name: String
  
  # Relaciones
  apartmentID: ID @index(name: "byApartment")
  apartment: Apartment @belongsTo(fields: ["apartmentID"])
  packages: [Package] @hasMany(indexName: "byRecipient", fields: ["id"])
}

# Habilitamos acceso PÃšBLICO para que el seeder pueda crear apartamentos
type Apartment @model @auth(rules: [
  { allow: public }
]) {
  id: ID!
  tower: String!
  unitNumber: String!
  accessCode: String!
  residents: [User] @hasMany(indexName: "byApartment", fields: ["id"])
}

type Package @model @auth(rules: [{ allow: public }]) {
  id: ID!
  courier: String!
  photoKey: String
  receivedAt: AWSDateTime!
  deliveredAt: AWSDateTime
  recipientID: ID! @index(name: "byRecipient")
  recipient: User @belongsTo(fields: ["recipientID"])
  status: PackageStatus!
  
  # ðŸ‘‡ NUEVOS CAMPOS PARA LA ENTREGA
  signatureKey: String
  deliveryMethod: DeliveryMethod # Enum nuevo
}

enum DeliveryMethod {
  QR_WITH_SIGNATURE
  MANUAL_WITH_SIGNATURE
  MANUAL_NO_SIGNATURE
}

enum PackageStatus {
  IN_WAREHOUSE
  DELIVERED
}